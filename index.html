<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>539 掉落號碼分析</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  table { border-collapse: collapse; width: 100%; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  th { background-color: #f4f4f4; }
</style>
</head>
<body>

<h2>539 掉落號碼分析</h2>
<input type="file" id="csvFile" accept=".csv">
<table id="resultTable">
  <thead>
    <tr>
      <th>期號</th>
      <th>本期號碼</th>
      <th>掉落號碼</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
document.getElementById('csvFile').addEventListener('change', function(e){
  const file = e.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(e){
    const text = e.target.result;
    const lines = text.trim().split('\n');
    const data = lines.map(line => line.split(',').map(x => x.trim()));

    const tbody = document.querySelector('#resultTable tbody');
    tbody.innerHTML = '';

    let prevNumbers = [];

    data.forEach(row => {
      const term = row[0];
      const numbers = row.slice(1);
      const dropped = numbers.filter(n => prevNumbers.includes(n));

      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${term}</td>
        <td>${numbers.join(', ')}</td>
        <td>${dropped.join(', ')}</td>
      `;
      tbody.appendChild(tr);

      prevNumbers = numbers;
    });
  };
  reader.readAsText(file);
});
</script>

</body>
</html>
