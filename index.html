<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>539 版路模擬驗證系統</title>
<style>
body { font-family: Arial; padding: 20px; }
textarea { width: 100%; height: 160px; }
button { padding: 8px 16px; margin-top: 10px; }
.result { margin-top: 20px; line-height: 1.8; }
.code { background: #f5f5f5; padding: 10px; }
</style>
</head>
<body>

<h2>539 下期預測版路模擬系統</h2>

<p>貼上 CSV 歷史資料：</p>
<textarea id="csvInput">
開獎日期,獎號1,獎號2,獎號3,獎號4,獎號5
2025/01/01,2,7,8,10,14
2025/01/02,12,26,30,32,33
2025/01/03,5,6,8,11,14
</textarea>

<br>
<button onclick="runSimulation()">執行模擬驗證</button>

<div class="result" id="output"></div>

<script>
function runSimulation() {
    const csv = document.getElementById("csvInput").value.trim();
    const rows = csv.split("\n").slice(1).map(r => r.split(","));

    if (rows.length < 3) {
        alert("資料至少需要 3 期以上");
        return;
    }

    // 取最後一期做驗證
    const actual = rows[rows.length - 1].slice(1).map(Number);

    // 訓練資料（不含最後一期）
    const training = rows.slice(0, rows.length - 1);

    // === 版路示範：近 N 期熱號 ===
    const N = 10;
    const freq = {};

    training.slice(-N).forEach(row => {
        row.slice(1).forEach(num => {
            freq[num] = (freq[num] || 0) + 1;
        });
    });

    // 排除上一期已開過的號碼
    const lastDraw = training[training.length - 1].slice(1).map(Number);

    const candidates = Object.entries(freq)
        .filter(([n]) => !lastDraw.includes(Number(n)))
        .sort((a, b) => b[1] - a[1])
        .map(e => Number(e[0]));

    const prediction = candidates.slice(0, 5);

    // 命中計算
    const hit = prediction.filter(n => actual.includes(n));

    document.getElementById("output").innerHTML = `
        <b>驗證期實際開獎：</b> ${actual.join(", ")}<br>
        <b>預測號碼：</b> ${prediction.join(", ")}<br>
        <b>命中號碼：</b> ${hit.join(", ") || "無"}<br>
        <b>命中顆數：</b> ${hit.length} / 5
        <hr>
        <b>使用版路：</b>
        <div class="code">
        近 ${N} 期熱號 + 排除上一期號碼
        </div>
    `;
}
</script>

</body>
</html>
